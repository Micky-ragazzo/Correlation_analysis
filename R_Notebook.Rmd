---
title: "Correlation analysis" 
output: html_notebook
---
This is an Correlation report
Data was taken from MES replication database.
*Wuchtvers_anz* column was extract from MES report system based on DMC using SQL query. </br>
<b>The goal of that report find describe one or more possible scenario in case when:</b>  
 - covariance value; </br> 
 - x depends on y; </br>
 - y depends on x; </br>
 - z depends on x; </br>

```{r}
summary(df)
```
Visualize and checking distribution before normalize dataset
The first one feature is: <b>R_SH</b>
```{r echo=FALSE}
 z_df %>% 
    dplyr::select(-input_DMC, -MD1_ANLIEF_MG, -Wuchtvers_anz, R_SH, -MD2_ANLIEF_G) %>% 
     gather(Variable, Value) %>% 
     ggplot(aes(x=Value, fill=Variable)) +
     geom_density(alpha=0.4) +
     geom_vline(aes(xintercept=0)) +
    theme_light() +
    scale_fill_brewer(palette="Spectral")
```
The next one feature is: <b>Wuchtvers_anz</b>
```{r echo=FALSE}
 z_df %>% 
    dplyr::select(-input_DMC, -MD1_ANLIEF_MG, Wuchtvers_anz, -R_SH, -MD2_ANLIEF_G) %>% 
     gather(Variable, Value) %>% 
     ggplot(aes(x=Value, fill=Variable)) +
     geom_density(alpha=0.4) +
     geom_vline(aes(xintercept=0)) +
    theme_light() +
    scale_fill_brewer(palette="Spectral")
```
The next  one feature is: <b>MD1_ANLIEF_MG</b>                    
```{r echo=FALSE}
 z_df %>% 
    dplyr::select(-input_DMC, -Status, MD1_ANLIEF_MG, -Wuchtvers_anz, -R_SH, -MD2_ANLIEF_G) %>% 
     gather(Variable, Value) %>% 
     ggplot(aes(x=Value, fill=Variable)) +
     geom_density(alpha=0.4) +
     geom_vline(aes(xintercept=0)) +
    theme_light() +
    scale_fill_brewer(palette="Spectral")
```                                                       
The next  one feature is: <b>MD2_ANLIEF_G</b>                    
```{r echo=FALSE}
 z_df %>% 
    dplyr::select(-input_DMC, -Status, -MD1_ANLIEF_MG, -Wuchtvers_anz, -R_SH, MD2_ANLIEF_G) %>% 
     gather(Variable, Value) %>% 
     ggplot(aes(x=Value, fill=Variable)) +
     geom_density(alpha=0.4) +
     geom_vline(aes(xintercept=0)) +
    theme_light() +
    scale_fill_brewer(palette="Spectral")
``` 
To summarize:</br>
- Skewness > 0 – Right skewed distribution – most values are concentrated on left of the mean, with extreme values to the right.</br>
- Skewness < 0 – Left skewed distribution – most values are concentrated on the right of the mean, with extreme values to the left.</br>
- Skewness = 0 – mean = median, the distribution is symmetrical around the mean. </br>

<p>A small p-value (typically ≤ 0.05) indicates strong evidence against the null hypothesis, so you reject the null hypothesis.

A large p-value (> 0.05) indicates weak evidence against the null hypothesis, so you fail to reject the null hypothesis.

p-values very close to the cutoff (0.05) are considered to be marginal (could go either way). Always report the p-value so your readers can draw their own conclusions.
</p>


  x<-(x - min(x)) / (max(x) - min(x))
Analiza korelacji 
```{r}
ggplot(z_df, aes(x=Wuchtvers_anz, y=R_SH)) + 
     geom_point(color='#2980B9', size = 3) + 
    geom_smooth(method=lm, se=FALSE, fullrange=TRUE, color='#2C3E50')
```

Creating non-linear models to desribe and find pattern: 

DEnsity - We frequently encounter the situation where we would like to understand how a particular variable is distributed in a dataset.

Linear approach 
<b>1. Finds the best parametric model to fit your data. It is hard to describe a model (which must describe all possible data points) without using a parametric distribution.
</b>
<b>
But for a model, each data point falls around the function that describes the model. In fact, the data points are distributed around the function (as you know).
</b>
<b>
Likelihood describes the chance that a given model caused the observation that has come to pass. It reasons from observation to model. For this reason, likelihood is sometimes called inverse probability.
Although likelihood and probability both deal with chances they behave differently mathematically. Most notably, the probability of disjoint events must sum to one. Not so for likelihoods.
</b>
```{r}
lm_mod <- lm(R_SH ~ Wuchtvers_anz, data = df)
termplot(lm_mod, partial.resid = TRUE, se = TRUE)
```
```{r}
ggpairs(data=z_schaft, columns=3:7, title="trees data")
```
```{r}
ggpairs(data=df, columns=1:4, title="trees data")

```

When we 
```{r}
gam_mod <- gam(Final_2 ~ s(Wuchtvers_anz, k=1), data = z_schaft)
plot(gam_mod, residuals = TRUE, pch = 1)
```
```{r}
gam_mod <- gam(Wuchtvers_anz ~ s(Final_1), data = z_schaft)
plot(gam_mod, residuals = TRUE, pch = 1)
```
```{r}
ggpairs(data=df, columns=1:3, title="trees data")
```


df